!function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}({10:function(e,t){function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var i={fname:"",lname:"",mname:"",email:"",password:"",username:"",role:{ceo:"ceo"}},r=document.getElementById("register_root");function s(e){return fetch("/register",{method:"post",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e})}).then((function(e){return e.ok?e.json():new Promise((function(e,t){t("Server error, user probably not saved")}))})).catch((function(e){return new Promise((function(e,t){t("Server error, user probably not saved")}))}))}var l=function(e){function t(t){var a;return(a=e.call(this,t)||this).state={},a.handlePassChange=a.handlePassChange.bind(n(a)),s(i).catch((function(e){console.log(e)})),a}a(t,e);var r=t.prototype;return r.handlePassChange=function(e){},r.render=function(){return React.createElement("div",{className:""},React.createElement("div",null,React.createElement("p",null,"Thank you for registering"),React.createElement("p",null,React.createElement("i",{className:"fa fa-check w3-text-green"}),"Just one more step to go"),React.createElement("div",null,React.createElement("p",null,"A verification Email has been sent to your email. Please confirm that the email your submitted is yours"))),React.createElement("div",null))},t}(React.Component),c=function(e){function t(t){var a;return(a=e.call(this,t)||this).state={name:(i.lname?i.lname+" ":"")+(i.fname?i.fname+" ":"")+(i.mname?i.mname:"")||"",isValid:!1},a.onChange=a.onChange.bind(n(a)),a}a(t,e);var r=t.prototype;return r.onChange=function(e){var t=this,n=e.target.value,a=n.split(" "),r=a[0],s=a[1],l=a[2];this.setState((function(e){return e.name=n,i.fname=s||"",i.lname=r||"",i.mname=l||"",i.fname&&(i.lname||i.mname)&&(e.isValid=!0),e}),(function(){console.log(t.state.name),t.state.isValid?t.props.hasEdited(!0):t.props.hasEdited(!1)}))},r.render=function(){var e=this.state.isValid;return React.createElement("div",{className:"div_subview"},React.createElement("div",{className:"div_label"},React.createElement("p",null,"Full name here..")),React.createElement("div",null,e?React.createElement("i",{className:"fa fa-check w3-text-green"}):null,React.createElement("input",{required:!0,value:this.state.name,onChange:this.onChange,className:"input_name"})))},t}(React.Component),o=(React.Component,function(e){function t(t){var a;return(a=e.call(this,t)||this).state={password:i.password||"",re_pass:"",equal:!0,validPass:!1},a.handlePassChange=a.handlePassChange.bind(n(a)),a.handleRePassChange=a.handleRePassChange.bind(n(a)),a}a(t,e);var r=t.prototype;return r.handleRePassChange=function(e){var t=e.target.value,n=e.target;this.setState((function(e){return e.re_pass=t,t.length>0&&e.password!==e.re_pass?(e.equal=!1,n.classList.add("pass_error"),console.log()):(n.classList.remove("pass_error"),i.password=t,e.equal=!0,console.log("equal")),e}))},r.handlePassChange=function(e){var t=this,n=e.target.value;this.setState((function(e){return e.password=n,i.password=n,e.password!==e.re_pass?(e.equal=!1,e.validPass=!0):(e.equal=!0,e.validPass=!1,i.password=n),e}),(function(){console.log(t.state.password),i.password?t.props.hasEdited(!0):t.props.hasEdited(!1)}))},r.render=function(){return React.createElement("div",{className:""},React.createElement("div",{className:"div_label"},React.createElement("label",null,"Enter password....")),React.createElement("div",null,this.state.validPass?React.createElement("i",{className:"fa fa-check w3-text-green"}):React.createElement("i",null),React.createElement("input",{className:"input_pass",type:"password",autocomplete:"new-password",value:this.state.pass,onChange:this.handlePassChange})),React.createElement("div",{className:"div_label"},React.createElement("label",null,"Confirm password....")),React.createElement("div",null,this.state.equal&&this.state.re_pass?React.createElement("i",{className:"fa fa-check w3-text-green"}):!this.state.equal&&this.state.re_pass?React.createElement("i",{className:"fa fa-remove w3-text-red"}):null," ",React.createElement("input",{className:"input_pass",type:"password",placeholder:"Please confirm password...",value:this.state.re_pass,onChange:this.handleRePassChange})))},t}(React.Component)),u=function(e){function t(t){var a;return(a=e.call(this,t)||this).state={username:i.username||"",validUsername:!0,isUnique:!0},a.props.hasEdited(!!a.state.username),a.onChange=a.onChange.bind(n(a)),a}a(t,e);var r=t.prototype;return r.onChange=function(e){var t=this,n=e.target.value;this.setState((function(e){return i.username=n,e.username=n,e.isUnique=!0,e.validUsername=!0,e}),(function(){n.length>1&&(t.state.username,fetch("/validate/username",{method:"post",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i.username})}).then((function(e){return e.ok?e.json():new Promise((function(e,t){t("server error!")}))})).catch((function(e){return new Promise((function(e,t){t("server error!")}))}))).then((function(e){e.valid?t.props.hasEdited(!0):t.setState((function(e){return e.isUnique=!1,e.validUsername=!1,e}))})).catch((function(e){console.log("Could not validate!"),t.hasEdited(!1)})),console.log(t.state.username)}))},r.render=function(){return React.createElement("div",{className:"div_subview"},React.createElement("div",{className:"div_label"},React.createElement("label",null,"Enter username...")),React.createElement("input",{value:this.state.username,onChange:this.onChange,className:"input_text"}),this.state.isUnique?null:React.createElement("div",null,React.createElement("p",null,"Username already taken")),this.state.validUsername?null:React.createElement("div",null,React.createElement("p",null,"Username not valid")))},t}(React.Component),d=function(e){function t(t){var a;return a=e.call(this,t)||this,console.log(a.state),a.state={email:i.email||"",validEmail:!0,isUnique:!0},a.props.hasEdited(!!a.state.email),a.onChange=a.onChange.bind(n(a)),a}a(t,e);var r=t.prototype;return r.onChange=function(e){var t=this,n=e.target.value;this.setState((function(e){return i.email=n,e.email=n,e.isUnique=!0,e.validEmail=!0,e}),(function(){n.length>1&&(t.state.email,fetch("/validate/email",{method:"post",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i.email})}).then((function(e){return e.ok?e.json():new Promise((function(e,t){t("Server Error")}))})).catch((function(e){return new Promise((function(t,n){n(e)}))}))).then((function(e){e.valid?t.props.hasEdited(!0):t.setState((function(e){return e.isUnique=!1,e.validEmail=!1,e}))})).catch((function(e){console.log(e),t.props.hasEdited(!1)})),console.log(t.state.email)}))},r.render=function(){return React.createElement("div",{className:"div_subview"},React.createElement("div",{className:"div_label"},React.createElement("p",null,"Enter email...")),React.createElement("input",{value:this.state.email,onChange:this.onChange,className:"input_text"}),this.state.isUnique?null:React.createElement("div",null,React.createElement("p",null,"Email already taken")),this.state.validEmail?null:React.createElement("div",null,React.createElement("p",null,"Email not valid")))},t}(React.Component),m=[{viewItem:c,type:"name"},{viewItem:d,type:"email"},{viewItem:u,type:"username"},{viewItem:o,type:"password"},{viewItem:l,type:"pre_email"}],h=function(e){function t(t){var a;return(a=e.call(this,t)||this).state={view:0,canNext:!1},a.handleNextClick=a.handleNextClick.bind(n(a)),a.handleRegisterClick=a.handleRegisterClick.bind(n(a)),a.handlePrevClick=a.handlePrevClick.bind(n(a)),a.handleReloadClick=a.handleReloadClick.bind(n(a)),a.handleViewEdit=a.handleViewEdit.bind(n(a)),a}a(t,e);var r=t.prototype;return r.handleRegisterClick=function(e){var t=this;e.preventDefault();this.state.view;s(i).then((function(e){return e.isSaved?fetch("/login",{method:"post",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i.username,password:i.password})}).then((function(e){return e.ok?e.json():new Promise((function(e,t){t("Server error, user probably not saved")}))})).catch((function(e){return new Promise((function(e,t){t("Server error, user probably not saved")}))})):new Promise((function(e,t){t("Likely server error")}))})).then((function(e){if(!e.isLoggedIn)return new Promise((function(e,t){t("Likely server error")}));console.log("You're logged in"),m.length-1>t.state.view&&t.setState({view:++t.state.view,canNext:!1})})).catch((function(e){console.log(e)}))},r.handleNextClick=function(e){e.preventDefault();this.state.view;m.length-1>this.state.view&&this.setState({view:++this.state.view,canNext:!1})},r.handleReloadClick=function(e){this.setState((function(e){return e}))},r.handleViewEdit=function(e){this.setState((function(t){return t.canNext=e,t}))},r.handlePrevClick=function(e){this.state.view>0&&this.setState({view:--this.state.view})},r.render=function(){view=this.state.view;var e,t=3===view?React.createElement("div",{className:"div_next w3-btn w3-cyan w3-text-white",onClick:this.handleRegisterClick},"Save"):React.createElement("div",{className:"div_next w3-btn w3-cyan w3-text-white",onClick:this.handleNextClick},"Next");switch(view){case 0:e=React.createElement(c,{hasEdited:this.handleViewEdit,view:view});break;case 1:e=React.createElement(d,{hasEdited:this.handleViewEdit,view:view});break;case 2:e=React.createElement(u,{hasEdited:this.handleViewEdit,view:view});break;case 3:e=React.createElement(o,{hasEdited:this.handleViewEdit,view:view});break;case 4:e=React.createElement(l,{hasEdited:this.handleViewEdit,view:view})}React.createElement("div",null,React.createElement("p",null,"Thanks for registering with us!"));return React.createElement("form",{className:"div_superview"},React.createElement("div",{className:"div_inputview"},e),React.createElement("div",{className:"div_controls"},view>0?React.createElement("div",{onClick:this.handlePrevClick,className:"div_prev w3-btn w3-cyan w3-text-white"},"Back"):null,this.state.canNext?t:null,React.createElement("div",{className:"w3-hide",onClick:this.handleReloadClick},"Log in Via")))},t}(React.Component);ReactDOM.render(React.createElement(h,null),r)}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3VzZXJfcmVnLmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwidXNlciIsImZuYW1lIiwibG5hbWUiLCJtbmFtZSIsImVtYWlsIiwicGFzc3dvcmQiLCJ1c2VybmFtZSIsInJvbGUiLCJjZW8iLCJyb290IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInJlZ2lzdGVyIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJlcnIiLCJQcmVFbWFpbFZlcmlmeSIsInByb3BzIiwic3RhdGUiLCJoYW5kbGVQYXNzQ2hhbmdlIiwiY29uc29sZSIsImxvZyIsImV2ZW50IiwicmVuZGVyIiwiY2xhc3NOYW1lIiwiUmVhY3QiLCJDb21wb25lbnQiLCJOYW1lIiwiaXNWYWxpZCIsIm9uQ2hhbmdlIiwiZSIsInRhcmdldCIsInNwbGl0IiwidGhpcyIsInNldFN0YXRlIiwiaGFzRWRpdGVkIiwicmVxdWlyZWQiLCJQYXNzd29yZCIsInJlX3Bhc3MiLCJlcXVhbCIsInZhbGlkUGFzcyIsImhhbmRsZVJlUGFzc0NoYW5nZSIsImVsZW0iLCJsZW5ndGgiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJ0eXBlIiwiYXV0b2NvbXBsZXRlIiwicGFzcyIsInBsYWNlaG9sZGVyIiwiVXNlcm5hbWUiLCJ2YWxpZFVzZXJuYW1lIiwiaXNVbmlxdWUiLCJ2YWxpZCIsIkVtYWlsIiwidmFsaWRFbWFpbCIsInZpZXdBcnJheSIsInZpZXdJdGVtIiwiUmVnaXN0ZXJBcHAiLCJ2aWV3IiwiY2FuTmV4dCIsImhhbmRsZU5leHRDbGljayIsImhhbmRsZVJlZ2lzdGVyQ2xpY2siLCJoYW5kbGVQcmV2Q2xpY2siLCJoYW5kbGVSZWxvYWRDbGljayIsImhhbmRsZVZpZXdFZGl0IiwicHJldmVudERlZmF1bHQiLCJpc1NhdmVkIiwiaXNMb2dnZWRJbiIsImNhbl9tb3ZlX3RvX25leHQiLCJWaWV3Iiwic3VibWl0QnRuIiwib25DbGljayIsIlJlYWN0RE9NIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIs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LG9CQUFDb0MsRUFBRCxNQUFpQjdEIiwiZmlsZSI6InVzZXJfcmVnLmJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAxMCk7XG4iLCJ2YXIgdXNlciA9IHtcclxuICAgIGZuYW1lOiBcIlwiLFxyXG4gICAgbG5hbWU6IFwiXCIsXHJcbiAgICBtbmFtZTogXCJcIixcclxuICAgIGVtYWlsOiBcIlwiLFxyXG4gICAgcGFzc3dvcmQ6IFwiXCIsXHJcbiAgICB1c2VybmFtZTogXCJcIixcclxuICAgIHJvbGU6e1xyXG4gICAgICAgIGNlbzpcImNlb1wiXHJcbiAgICB9XHJcbn1cclxuXHJcbmNvbnN0IHJvb3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlZ2lzdGVyX3Jvb3RcIilcclxuLy9yZXByZXNlbnRzIHRoZSBuYW1lIG9mIGEgcHJvZHVjdFxyXG5mdW5jdGlvbiB2YWxFbWFpbCgpIHtcclxuICAgIHJldHVybiBmZXRjaChcIi92YWxpZGF0ZS9lbWFpbFwiLCB7XHJcbiAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcclxuICAgICAgICBtb2RlOiBcImNvcnNcIixcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGVtYWlsOiB1c2VyLmVtYWlsIH0pXHJcbiAgICB9KS50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIFxyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIHJlamVjdCgnU2VydmVyIEVycm9yJylcclxuICAgICAgICAgICAgfSlcclxuICAgIH0pLlxyXG4gICAgY2F0Y2goZXJyID0+IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgcmVqZWN0KGVycilcclxuICAgICAgICAgICAgfSkpXHJcbn1cclxuZnVuY3Rpb24gdmFsVXNlcm5hbWUoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goXCIvdmFsaWRhdGUvdXNlcm5hbWVcIiwge1xyXG4gICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAgICAgbW9kZTogXCJjb3JzXCIsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyB1c2VybmFtZTogdXNlci51c2VybmFtZSB9KVxyXG4gICAgfSkudGhlbihyZXMgPT4ge1xyXG4gICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKClcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLHJlamVjdCk9PntyZWplY3QoXCJzZXJ2ZXIgZXJyb3IhXCIpfSlcclxuICAgIH0pLmNhdGNoKGVyciA9PiBuZXcgUHJvbWlzZSgocmVzb2x2ZSxyZWplY3QpPT57cmVqZWN0KFwic2VydmVyIGVycm9yIVwiKX0pIClcclxufVxyXG5mdW5jdGlvbiByZWdpc3Rlcih1c2VyKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goXCIvcmVnaXN0ZXJcIiwge1xyXG4gICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAgICAgbW9kZTogXCJjb3JzXCIsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyB1c2VyIH0pXHJcbiAgICB9KS50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUscmVqZWN0KT0+e1xyXG4gICAgICAgICAgICByZWplY3QoXCJTZXJ2ZXIgZXJyb3IsIHVzZXIgcHJvYmFibHkgbm90IHNhdmVkXCIpXHJcbiAgICAgICAgfSlcclxuICAgIH0pLmNhdGNoKGVyciA9PiBuZXcgUHJvbWlzZSgocmVzb2x2ZSxyZWplY3QpPT57XHJcbiAgICAgICAgICAgIHJlamVjdChcIlNlcnZlciBlcnJvciwgdXNlciBwcm9iYWJseSBub3Qgc2F2ZWRcIilcclxuICAgICAgICB9KSlcclxufVxyXG5mdW5jdGlvbiB2ZXJpZnlFbWFpbCgpIHtcclxuICAgIHJldHVybiBmZXRjaChcIi92ZXJpZnlfZW1haWxcIiwge1xyXG4gICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAgICAgbW9kZTogXCJjb3JzXCIsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyB1c2VybmFtZTogdXNlci51c2VybmFtZSwgcGFzc3dvcmQ6IHVzZXIucGFzc3dvcmQgfSl9KS50aGVuKHJlcz0+e1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICByZXMuanNvbigpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS50aGVuKHJlcz0+e1xyXG4gICAgICAgICAgICBpZiAocmVzLmlzU2VudFZlckVtYWlsKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVtYWlsIHNlbnRcIilcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG59XHJcbmZ1bmN0aW9uIGF1dG9Mb2dpbigpIHtcclxuICAgIHJldHVybiBmZXRjaChcIi9sb2dpblwiLCB7XHJcbiAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcclxuICAgICAgICBtb2RlOiBcImNvcnNcIixcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IHVzZXJuYW1lOiB1c2VyLnVzZXJuYW1lLCBwYXNzd29yZDogdXNlci5wYXNzd29yZCB9KVxyXG4gICAgfSkudGhlbihyZXM9PntcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSxyZWplY3QpPT57XHJcbiAgICAgICAgICAgICAgICByZWplY3QoXCJTZXJ2ZXIgZXJyb3IsIHVzZXIgcHJvYmFibHkgbm90IHNhdmVkXCIpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfSkuY2F0Y2goZXJyPT4gbmV3IFByb21pc2UoKHJlc29sdmUscmVqZWN0KT0+e1xyXG4gICAgICAgICAgICByZWplY3QoXCJTZXJ2ZXIgZXJyb3IsIHVzZXIgcHJvYmFibHkgbm90IHNhdmVkXCIpXHJcbiAgICAgICAgfSkpXHJcbn1cclxuY2xhc3MgUHJlRW1haWxWZXJpZnkgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgICAgICBzdXBlcihwcm9wcylcclxuICAgICAgICB0aGlzLnN0YXRlID0ge31cclxuICAgICAgICB0aGlzLmhhbmRsZVBhc3NDaGFuZ2UgPSB0aGlzLmhhbmRsZVBhc3NDaGFuZ2UuYmluZCh0aGlzKVxyXG4gICAgICAgIHJlZ2lzdGVyKHVzZXIpLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycilcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZVBhc3NDaGFuZ2UoZXZlbnQpIHtcclxuXHJcbiAgICB9XHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuICg8ZGl2IGNsYXNzTmFtZT1cIlwiPlxyXG4gICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgPHA+VGhhbmsgeW91IGZvciByZWdpc3RlcmluZzwvcD5cclxuICAgICAgICAgICAgICAgIDxwPjxpIGNsYXNzTmFtZT1cImZhIGZhLWNoZWNrIHczLXRleHQtZ3JlZW5cIj48L2k+SnVzdCBvbmUgbW9yZSBzdGVwIHRvIGdvPC9wPlxyXG4gICAgICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICAgICAgICA8cD5BIHZlcmlmaWNhdGlvbiBFbWFpbCBoYXMgYmVlbiBzZW50IHRvIHlvdXIgZW1haWwuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFBsZWFzZSBjb25maXJtIHRoYXQgdGhlIGVtYWlsIHlvdXIgc3VibWl0dGVkIGlzIHlvdXJzPC9wPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj4pXHJcbiAgICB9XHJcbn1cclxuY2xhc3MgTmFtZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKVxyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgICAgIG5hbWU6ICgodXNlci5sbmFtZSA/IHVzZXIubG5hbWUgKyBcIiBcIiA6IFwiXCIpICtcclxuICAgICAgICAgICAgICAgICh1c2VyLmZuYW1lID8gdXNlci5mbmFtZSArIFwiIFwiIDogXCJcIikgKyAodXNlci5tbmFtZSA/IHVzZXIubW5hbWUgOiBcIlwiKSkgfHwgXCJcIixcclxuICAgICAgICAgICAgICAgIGlzVmFsaWQ6ZmFsc2UsXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMub25DaGFuZ2UgPSB0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcylcclxuICAgIH1cclxuICAgIG9uQ2hhbmdlKGUpIHtcclxuICAgICAgICBsZXQgbmFtZSA9IGUudGFyZ2V0LnZhbHVlXHJcbiAgICAgICAgbGV0IFtsbmFtZSwgZm5hbWUsIG1uYW1lXSA9IG5hbWUuc3BsaXQoXCIgXCIpXHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZShzdGF0ZSA9PiB7XHJcbiAgICAgICAgICAgIHN0YXRlLm5hbWUgPSBuYW1lXHJcbiAgICAgICAgICAgIHVzZXIuZm5hbWUgPSBmbmFtZSA/IGZuYW1lIDogXCJcIjtcclxuICAgICAgICAgICAgdXNlci5sbmFtZSA9IGxuYW1lID8gbG5hbWUgOiBcIlwiO1xyXG4gICAgICAgICAgICB1c2VyLm1uYW1lID0gbW5hbWUgPyBtbmFtZSA6IFwiXCI7XHJcbiAgICAgICAgICAgIGlmICh1c2VyLmZuYW1lICYmICh1c2VyLmxuYW1lIHx8IHVzZXIubW5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZS5pc1ZhbGlkPXRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gc3RhdGU7XHJcbiAgICAgICAgfSwgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnN0YXRlLm5hbWUpXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLmlzVmFsaWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuaGFzRWRpdGVkKHRydWUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmhhc0VkaXRlZChmYWxzZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgbGV0IGlzVmFsaWQ9dGhpcy5zdGF0ZS5pc1ZhbGlkO1xyXG4gICAgICAgIHJldHVybiAoPGRpdiBjbGFzc05hbWU9XCJkaXZfc3Vidmlld1wiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImRpdl9sYWJlbFwiPlxyXG4gICAgICAgICAgICAgICAgPHA+RnVsbCBuYW1lIGhlcmUuLjwvcD5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICB7aXNWYWxpZD8gPGkgY2xhc3NOYW1lPVwiZmEgZmEtY2hlY2sgdzMtdGV4dC1ncmVlblwiPjwvaT46bnVsbH1cclxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQgcmVxdWlyZWQgdmFsdWU9e3RoaXMuc3RhdGUubmFtZX0gb25DaGFuZ2U9e3RoaXMub25DaGFuZ2V9IGNsYXNzTmFtZT1cImlucHV0X25hbWVcIiAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj4pXHJcbiAgICB9XHJcbn1cclxuY2xhc3MgRW5kb2ZMaW5lIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpXHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHsgY2FuTmV4dDogZmFsc2UgfVxyXG4gICAgICAgIHRoaXMub25DbGljayA9IHRoaXMub25DbGljay5iaW5kKHRoaXMpXHJcbiAgICB9XHJcbiAgICBvbkNsaWNrKGUpIHtcclxuICAgICAgICBmZXRjaChcIi9yZWdpc3RlclwiLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHVzZXIpXHJcbiAgICAgICAgfSkudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLmlzU2F2ZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuaGFzRWRpdGVkKHRydWUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpXHJcbiAgICAgICAgICAgIHRoaXMucHJvcHMuaGFzRWRpdGVkKHRydWUpXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICByZXR1cm4gKDxkaXYgY2xhc3NOYW1lPVwiZGl2X3N1YnZpZXdcIj5cclxuICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgb25DbGljaz17dGhpcy5vbkNsaWNrfSBjbGFzc05hbWU9XCJcIj5SZWdpc3RlcjwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj4pXHJcbiAgICB9XHJcbn1cclxuY2xhc3MgUGFzc3dvcmQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgICAgICBzdXBlcihwcm9wcylcclxuICAgICAgICB0aGlzLnN0YXRlID0geyBwYXNzd29yZDogdXNlci5wYXNzd29yZCB8fCBcIlwiLCByZV9wYXNzOiBcIlwiLCBlcXVhbDogdHJ1ZSwgdmFsaWRQYXNzOiBmYWxzZSB9XHJcbiAgICAgICAgdGhpcy5oYW5kbGVQYXNzQ2hhbmdlID0gdGhpcy5oYW5kbGVQYXNzQ2hhbmdlLmJpbmQodGhpcylcclxuICAgICAgICB0aGlzLmhhbmRsZVJlUGFzc0NoYW5nZSA9IHRoaXMuaGFuZGxlUmVQYXNzQ2hhbmdlLmJpbmQodGhpcylcclxuICAgIH1cclxuICAgIGhhbmRsZVJlUGFzc0NoYW5nZShldmVudCkge1xyXG4gICAgICAgIGxldCB2YWx1ZSA9IGV2ZW50LnRhcmdldC52YWx1ZVxyXG4gICAgICAgIGxldCBlbGVtID0gZXZlbnQudGFyZ2V0XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZShzdGF0ZSA9PiB7XHJcbiAgICAgICAgICAgIHN0YXRlLnJlX3Bhc3MgPSB2YWx1ZTtcclxuICAgICAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDAgJiYgc3RhdGUucGFzc3dvcmQgIT09IHN0YXRlLnJlX3Bhc3MpIHtcclxuICAgICAgICAgICAgICAgIHN0YXRlLmVxdWFsID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBlbGVtLmNsYXNzTGlzdC5hZGQoXCJwYXNzX2Vycm9yXCIpXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygpXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJwYXNzX2Vycm9yXCIpXHJcbiAgICAgICAgICAgICAgICAvL29ubHkgdXBkYXRlIHBhc3N3b3JkIGlmIHBhc3N3b3JkIGVxdWFsIHRvIHJlX3Bhc3MgXHJcbiAgICAgICAgICAgICAgICB1c2VyLnBhc3N3b3JkID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZS5lcXVhbCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImVxdWFsXCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICBoYW5kbGVQYXNzQ2hhbmdlKGV2ZW50KSB7XHJcbiAgICAgICAgbGV0IHZhbHVlID0gZXZlbnQudGFyZ2V0LnZhbHVlXHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZShzdGF0ZSA9PiB7XHJcbiAgICAgICAgICAgIHN0YXRlLnBhc3N3b3JkID0gdmFsdWU7XHJcbiAgICAgICAgICAgIHVzZXIucGFzc3dvcmQgPSB2YWx1ZVxyXG4gICAgICAgICAgICBpZiAoc3RhdGUucGFzc3dvcmQgIT09IHN0YXRlLnJlX3Bhc3MpIHtcclxuICAgICAgICAgICAgICAgIHN0YXRlLmVxdWFsID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZS52YWxpZFBhc3MgPSB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc3RhdGUuZXF1YWwgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgc3RhdGUudmFsaWRQYXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAvL29ubHkgdXBkYXRlIHBhc3N3b3JkIGlmIHBhc3N3b3JkIGVxdWFsIHRvIHJlX3Bhc3MgXHJcbiAgICAgICAgICAgICAgICB1c2VyLnBhc3N3b3JkID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlO1xyXG4gICAgICAgIH0sICgpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5zdGF0ZS5wYXNzd29yZClcclxuICAgICAgICAgICAgaWYgKHVzZXIucGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuaGFzRWRpdGVkKHRydWUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmhhc0VkaXRlZChmYWxzZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuICg8ZGl2IGNsYXNzTmFtZT1cIlwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImRpdl9sYWJlbFwiPlxyXG4gICAgICAgICAgICAgICAgPGxhYmVsPkVudGVyIHBhc3N3b3JkLi4uLjwvbGFiZWw+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAge3RoaXMuc3RhdGUudmFsaWRQYXNzID8gPGkgY2xhc3NOYW1lPVwiZmEgZmEtY2hlY2sgdzMtdGV4dC1ncmVlblwiPjwvaT4gOiA8aT48L2k+fSBcclxuICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzc05hbWU9XCJpbnB1dF9wYXNzXCIgdHlwZT1cInBhc3N3b3JkXCIgYXV0b2NvbXBsZXRlPVwibmV3LXBhc3N3b3JkXCJcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS5wYXNzfSBvbkNoYW5nZT17dGhpcy5oYW5kbGVQYXNzQ2hhbmdlfSAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkaXZfbGFiZWxcIj5cclxuICAgICAgICAgICAgICAgIDxsYWJlbD5Db25maXJtIHBhc3N3b3JkLi4uLjwvbGFiZWw+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAge3RoaXMuc3RhdGUuZXF1YWwmJnRoaXMuc3RhdGUucmVfcGFzcz8gPGkgY2xhc3NOYW1lPVwiZmEgZmEtY2hlY2sgdzMtdGV4dC1ncmVlblwiPjwvaT4gOiBcclxuICAgICAgICAgICAgICAgKCF0aGlzLnN0YXRlLmVxdWFsJiZ0aGlzLnN0YXRlLnJlX3Bhc3M/PGkgY2xhc3NOYW1lPVwiZmEgZmEtcmVtb3ZlIHczLXRleHQtcmVkXCI+PC9pPjpudWxsKVxyXG4gICAgICAgICAgICB9IDxpbnB1dCBjbGFzc05hbWU9XCJpbnB1dF9wYXNzXCIgdHlwZT1cInBhc3N3b3JkXCIgcGxhY2Vob2xkZXI9XCJQbGVhc2UgY29uZmlybSBwYXNzd29yZC4uLlwiXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUucmVfcGFzc30gb25DaGFuZ2U9e3RoaXMuaGFuZGxlUmVQYXNzQ2hhbmdlfSAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj4pXHJcbiAgICB9XHJcbn1cclxuY2xhc3MgVXNlcm5hbWUgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgICAgICBzdXBlcihwcm9wcylcclxuICAgICAgICB0aGlzLnN0YXRlID0geyB1c2VybmFtZTogdXNlci51c2VybmFtZSB8fCBcIlwiLCB2YWxpZFVzZXJuYW1lOiB0cnVlLCBpc1VuaXF1ZTogdHJ1ZSB9XHJcbiAgICAgICAgdGhpcy5wcm9wcy5oYXNFZGl0ZWQoISF0aGlzLnN0YXRlLnVzZXJuYW1lKVxyXG4gICAgICAgIHRoaXMub25DaGFuZ2UgPSB0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcylcclxuICAgIH1cclxuICAgIG9uQ2hhbmdlKGUpIHtcclxuICAgICAgICBsZXQgdXNlcm5hbWUgPSBlLnRhcmdldC52YWx1ZVxyXG5cclxuICAgICAgICB0aGlzLnNldFN0YXRlKHN0YXRlID0+IHtcclxuICAgICAgICAgICAgdXNlci51c2VybmFtZSA9IHVzZXJuYW1lXHJcbiAgICAgICAgICAgIHN0YXRlLnVzZXJuYW1lID0gdXNlcm5hbWVcclxuICAgICAgICAgICAgc3RhdGUuaXNVbmlxdWUgPSB0cnVlXHJcbiAgICAgICAgICAgIHN0YXRlLnZhbGlkVXNlcm5hbWUgPSB0cnVlXHJcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZTtcclxuICAgICAgICB9LCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh1c2VybmFtZS5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICB2YWxVc2VybmFtZSh0aGlzLnN0YXRlLnVzZXJuYW1lKS50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy52YWxpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmhhc0VkaXRlZCh0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShzdGF0ZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5pc1VuaXF1ZSA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS52YWxpZFVzZXJuYW1lID0gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzdGF0ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzLnByb3BzLmhhc0VkaXRlZChmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ291bGQgbm90IHZhbGlkYXRlIVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzRWRpdGVkKGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnN0YXRlLnVzZXJuYW1lKVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuICg8ZGl2IGNsYXNzTmFtZT1cImRpdl9zdWJ2aWV3XCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZGl2X2xhYmVsXCI+XHJcbiAgICAgICAgICAgICAgICA8bGFiZWw+RW50ZXIgdXNlcm5hbWUuLi48L2xhYmVsPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGlucHV0IHZhbHVlPXt0aGlzLnN0YXRlLnVzZXJuYW1lfSBvbkNoYW5nZT17dGhpcy5vbkNoYW5nZX1cclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImlucHV0X3RleHRcIiAvPlxyXG4gICAgICAgICAgICB7dGhpcy5zdGF0ZS5pc1VuaXF1ZSA/IG51bGwgOiA8ZGl2PjxwPlVzZXJuYW1lIGFscmVhZHkgdGFrZW48L3A+XHJcbiAgICAgICAgICAgIDwvZGl2Pn1cclxuICAgICAgICAgICAge3RoaXMuc3RhdGUudmFsaWRVc2VybmFtZSA/IG51bGwgOiA8ZGl2PjxwPlVzZXJuYW1lIG5vdCB2YWxpZDwvcD5cclxuICAgICAgICAgICAgPC9kaXY+fVxyXG4gICAgICAgIDwvZGl2PilcclxuICAgIH1cclxufVxyXG5jbGFzcyBFbWFpbCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuc3RhdGUpXHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHsgZW1haWw6IHVzZXIuZW1haWwgfHwgXCJcIiwgdmFsaWRFbWFpbDogdHJ1ZSwgaXNVbmlxdWU6IHRydWUgfVxyXG4gICAgICAgIHRoaXMucHJvcHMuaGFzRWRpdGVkKCEhdGhpcy5zdGF0ZS5lbWFpbClcclxuICAgICAgICB0aGlzLm9uQ2hhbmdlID0gdGhpcy5vbkNoYW5nZS5iaW5kKHRoaXMpXHJcbiAgICB9XHJcbiAgICBvbkNoYW5nZShlKSB7XHJcbiAgICAgICAgbGV0IGVtYWlsID0gZS50YXJnZXQudmFsdWVcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHN0YXRlID0+IHtcclxuICAgICAgICAgICAgdXNlci5lbWFpbCA9IGVtYWlsXHJcbiAgICAgICAgICAgIHN0YXRlLmVtYWlsID0gZW1haWxcclxuICAgICAgICAgICAgc3RhdGUuaXNVbmlxdWUgPSB0cnVlXHJcbiAgICAgICAgICAgIHN0YXRlLnZhbGlkRW1haWwgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gc3RhdGU7XHJcbiAgICAgICAgfSwgKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZW1haWwubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgdmFsRW1haWwodGhpcy5zdGF0ZS5lbWFpbCkudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXMudmFsaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5oYXNFZGl0ZWQodHJ1ZSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHN0YXRlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmlzVW5pcXVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS52YWxpZEVtYWlsID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzLnByb3BzLmhhc0VkaXRlZChmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycilcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmhhc0VkaXRlZChmYWxzZSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5zdGF0ZS5lbWFpbClcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIHJldHVybiAoPGRpdiBjbGFzc05hbWU9XCJkaXZfc3Vidmlld1wiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImRpdl9sYWJlbFwiPlxyXG4gICAgICAgICAgICAgICAgPHA+RW50ZXIgZW1haWwuLi48L3A+PC9kaXY+XHJcbiAgICAgICAgICAgIDxpbnB1dCB2YWx1ZT17dGhpcy5zdGF0ZS5lbWFpbH0gb25DaGFuZ2U9e3RoaXMub25DaGFuZ2V9IGNsYXNzTmFtZT1cImlucHV0X3RleHRcIiAvPlxyXG4gICAgICAgICAgICB7dGhpcy5zdGF0ZS5pc1VuaXF1ZSA/IG51bGwgOiA8ZGl2PjxwPkVtYWlsIGFscmVhZHkgdGFrZW48L3A+XHJcbiAgICAgICAgICAgIDwvZGl2Pn1cclxuICAgICAgICAgICAge3RoaXMuc3RhdGUudmFsaWRFbWFpbCA/IG51bGwgOiA8ZGl2PjxwPkVtYWlsIG5vdCB2YWxpZDwvcD5cclxuICAgICAgICAgICAgPC9kaXY+fVxyXG4gICAgICAgIDwvZGl2PilcclxuICAgIH1cclxufVxyXG5sZXQgdmlld0FycmF5ID0gW3sgdmlld0l0ZW06IE5hbWUsIHR5cGU6IFwibmFtZVwiIH0sIHsgdmlld0l0ZW06IEVtYWlsLCB0eXBlOiBcImVtYWlsXCIsIH0sXHJcbnsgdmlld0l0ZW06IFVzZXJuYW1lLCB0eXBlOiBcInVzZXJuYW1lXCIgfSwgeyB2aWV3SXRlbTogUGFzc3dvcmQsIHR5cGU6IFwicGFzc3dvcmRcIiB9LFxyXG57IHZpZXdJdGVtOiBQcmVFbWFpbFZlcmlmeSwgdHlwZTogXCJwcmVfZW1haWxcIiB9XVxyXG5jbGFzcyBSZWdpc3RlckFwcCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKVxyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7IHZpZXc6IDAsIGNhbk5leHQ6IGZhbHNlIH1cclxuICAgICAgICB0aGlzLmhhbmRsZU5leHRDbGljayA9IHRoaXMuaGFuZGxlTmV4dENsaWNrLmJpbmQodGhpcylcclxuICAgICAgICB0aGlzLmhhbmRsZVJlZ2lzdGVyQ2xpY2sgPSB0aGlzLmhhbmRsZVJlZ2lzdGVyQ2xpY2suYmluZCh0aGlzKVxyXG4gICAgICAgIHRoaXMuaGFuZGxlUHJldkNsaWNrID0gdGhpcy5oYW5kbGVQcmV2Q2xpY2suYmluZCh0aGlzKVxyXG4gICAgICAgIHRoaXMuaGFuZGxlUmVsb2FkQ2xpY2sgPSB0aGlzLmhhbmRsZVJlbG9hZENsaWNrLmJpbmQodGhpcylcclxuICAgICAgICB0aGlzLmhhbmRsZVZpZXdFZGl0ID0gdGhpcy5oYW5kbGVWaWV3RWRpdC5iaW5kKHRoaXMpXHJcbiAgICB9XHJcbiAgICBoYW5kbGVSZWdpc3RlckNsaWNrKGUpe1xyXG4gICAgICAgIC8vcHJvY2VzcyBhbmQgdmFsaWRhdGUgdmFsdWVcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcclxuICAgICAgICBsZXQgaXRlbSA9IHZpZXdBcnJheVt0aGlzLnN0YXRlLnZpZXddXHJcbiAgICAgICAgcmVnaXN0ZXIodXNlcikudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLmlzU2F2ZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhdXRvTG9naW4oKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUscmVqZWN0KT0+e1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkxpa2VseSBzZXJ2ZXIgZXJyb3JcIilcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMuaXNMb2dnZWRJbikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJZb3UncmUgbG9nZ2VkIGluXCIpXHJcbiAgICAgICAgaWYgKHZpZXdBcnJheS5sZW5ndGggLSAxID4gdGhpcy5zdGF0ZS52aWV3KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyB2aWV3OiArK3RoaXMuc3RhdGUudmlldywgY2FuTmV4dDogZmFsc2UgfSlcclxuICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSxyZWplY3QpPT57XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTGlrZWx5IHNlcnZlciBlcnJvclwiKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pLmNhdGNoKGVycj0+e1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIGhhbmRsZU5leHRDbGljayhlKSB7XHJcbiAgICAgICAgLy9wcm9jZXNzIGFuZCB2YWxpZGF0ZSB2YWx1ZVxyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKVxyXG4gICAgICAgIGxldCBpdGVtID0gdmlld0FycmF5W3RoaXMuc3RhdGUudmlld11cclxuICAgICAgICBpZiAodmlld0FycmF5Lmxlbmd0aCAtIDEgPiB0aGlzLnN0YXRlLnZpZXcpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHZpZXc6ICsrdGhpcy5zdGF0ZS52aWV3LCBjYW5OZXh0OiBmYWxzZSB9KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVSZWxvYWRDbGljayhlKSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZShzdGF0ZSA9PiBzdGF0ZSlcclxuICAgIH1cclxuICAgIGhhbmRsZVZpZXdFZGl0KGNhbl9tb3ZlX3RvX25leHQpIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHN0YXRlID0+IHtcclxuICAgICAgICAgICAgc3RhdGUuY2FuTmV4dCA9IGNhbl9tb3ZlX3RvX25leHRcclxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIGhhbmRsZVByZXZDbGljayhlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUudmlldyA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHZpZXc6IC0tdGhpcy5zdGF0ZS52aWV3IH0pXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIHZpZXcgPSB0aGlzLnN0YXRlLnZpZXdcclxuICAgICAgICBsZXQgc3VibWl0QnRuPSB2aWV3PT09Mz8gXHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkaXZfbmV4dCB3My1idG4gdzMtY3lhbiB3My10ZXh0LXdoaXRlXCIgb25DbGljaz17dGhpcy5oYW5kbGVSZWdpc3RlckNsaWNrfT5TYXZlPC9kaXY+OlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZGl2X25leHQgdzMtYnRuIHczLWN5YW4gdzMtdGV4dC13aGl0ZVwiIG9uQ2xpY2s9e3RoaXMuaGFuZGxlTmV4dENsaWNrfT5OZXh0PC9kaXY+XHJcbiAgICAgICAgbGV0IFZpZXc7XHJcbiAgICAgICAgc3dpdGNoICh2aWV3KSB7XHJcbiAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgIFZpZXcgPSA8TmFtZSBoYXNFZGl0ZWQ9e3RoaXMuaGFuZGxlVmlld0VkaXR9IHZpZXc9e3ZpZXd9IC8+XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgVmlldyA9IDxFbWFpbCBoYXNFZGl0ZWQ9e3RoaXMuaGFuZGxlVmlld0VkaXR9IHZpZXc9e3ZpZXd9IC8+XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgVmlldyA9IDxVc2VybmFtZSBoYXNFZGl0ZWQ9e3RoaXMuaGFuZGxlVmlld0VkaXR9IHZpZXc9e3ZpZXd9IC8+XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgVmlldyA9IDxQYXNzd29yZCBoYXNFZGl0ZWQ9e3RoaXMuaGFuZGxlVmlld0VkaXR9IHZpZXc9e3ZpZXd9IC8+XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgVmlldyA9IDxQcmVFbWFpbFZlcmlmeSBoYXNFZGl0ZWQ9e3RoaXMuaGFuZGxlVmlld0VkaXR9IHZpZXc9e3ZpZXd9IC8+XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL2xldCBWaWV3ID0gdmlld0FycmF5W3ZpZXddLnZpZXdJdGVtXHJcbiAgICAgICAgbGV0IEVuZG9mTGluZSA9IDxkaXY+PHA+VGhhbmtzIGZvciByZWdpc3RlcmluZyB3aXRoIHVzITwvcD48L2Rpdj47XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPGZvcm0gY2xhc3NOYW1lPVwiZGl2X3N1cGVydmlld1wiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkaXZfaW5wdXR2aWV3XCI+e1ZpZXd9PC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImRpdl9jb250cm9sc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgIHt2aWV3ID4gMCA/IDxkaXYgb25DbGljaz17dGhpcy5oYW5kbGVQcmV2Q2xpY2t9IGNsYXNzTmFtZT1cImRpdl9wcmV2IHczLWJ0biB3My1jeWFuIHczLXRleHQtd2hpdGVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgQmFjazwvZGl2PiA6IG51bGx9XHJcbiAgICAgICAgICAgICAgICAgICAge3RoaXMuc3RhdGUuY2FuTmV4dCA/c3VibWl0QnRuOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidzMtaGlkZVwiIG9uQ2xpY2s9e3RoaXMuaGFuZGxlUmVsb2FkQ2xpY2t9PkxvZyBpbiBWaWE8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Zvcm0+XHJcbiAgICAgICAgKVxyXG4gICAgfVxyXG59XHJcblxyXG5SZWFjdERPTS5yZW5kZXIoPFJlZ2lzdGVyQXBwIC8+LCByb290KVxyXG5cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==